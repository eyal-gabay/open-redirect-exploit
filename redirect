#!/usr/bin/python3

from pyvirtualdisplay import Display
from selenium import webdriver
from time import sleep
from sys import argv


def run(sleep_time=0.0):
    # screen settings
    display = Display(visible=False, size=(800, 800))
    display.start()

    payloads = open("wc.txt").readlines()
    pre = ["/", "?next=", "?url=", "?target=", "?rurl=", "?dest=", "?destination=", "?redir=", "?redirect_uri=",
           "?redirect_url=", "?redirect=", "/redirect/"]
    if "-a" not in argv:
        urls = argv[1:]
    else:
        urls = argv[2:]

    try:
        with webdriver.Chrome() as firefox:
            for url in urls:
                for payload in payloads:
                    payload = payload.strip()
                    if "-a" not in argv:
                        print("---", url + "/" + payload)
                        try:
                            firefox.get(url + "/" + payload)
                        except:
                            pass
                        if url.split("://")[1].replace("www.", "") not in firefox.current_url:
                            print(url.split("://")[1], firefox.current_url)
                            print("found:", payload, ":)\n\n\n")
                            exit()
                        sleep(sleep_time)
                    else:
                        for pref in pre:
                            print("---", url + pref + payload)
                            try:
                                firefox.get(url + pref + payload)
                            except:
                                pass
                            if url.split("://")[1].replace("www.", "") not in firefox.current_url:
                                print(url.split("://")[1], firefox.current_url)
                                print("found:", payload, ":)\n\n\n")
                                exit()
                            sleep(sleep_time)
            else:
                exit(print("maybe next time :("))
    except KeyboardInterrupt:
        exit()


if "eyal is the best":
    run(0.0)


